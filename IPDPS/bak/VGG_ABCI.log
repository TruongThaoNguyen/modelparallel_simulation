python parallel_analysis.py -net VGG_ImageNet_prof.net -plat ABCI.plat -goal 1 --cmaxp 2048 --cmaxB 32768
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  VGG_ImageNet_prof.net
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
CONV1_1 	[3, 226, 226] 	[3, 64, 3, 3] 	[64, 226, 226] 	0.00118
RELU 	[64, 226, 226] 	[64, 64, 0, 0] 	[64, 226, 226] 	0.000215
CONV1_2 	[64, 226, 226] 	[64, 64, 3, 3] 	[64, 226, 226] 	0.000269
RELU 	[64, 226, 226] 	[64, 64, 0, 0] 	[64, 226, 226] 	7.26e-05
MPOOL 	[64, 226, 226] 	[0, 0, 2, 2] 	[64, 113, 113] 	5.88e-05
CONV2_1 	[64, 113, 113] 	[64, 128, 3, 3] 	[128, 113, 113] 	0.000162
RELU 	[128, 113, 113] 	[128, 128, 0, 0] 	[128, 113, 113] 	5.44e-05
CONV2_2 	[128, 113, 113] 	[128, 128, 3, 3] 	[128, 113, 113] 	0.000236
RELU 	[128, 113, 113] 	[128, 128, 0, 0] 	[128, 113, 113] 	5.37e-05
MPOOL 	[128, 113, 113] 	[0, 0, 2, 2] 	[128, 57, 57] 	4.3e-05
CONV3_1 	[128, 57, 57] 	[128, 256, 3, 3] 	[256, 57, 57] 	0.000167
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	4.64e-05
CONV3_2 	[256, 57, 57] 	[256, 256, 3, 3] 	[256, 57, 57] 	0.000268
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	4.56e-05
CONV3_3 	[256, 57, 57] 	[256, 256, 3, 3] 	[256, 57, 57] 	0.000268
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	4.6e-05
MPOOL 	[256, 57, 57] 	[0, 0, 2, 2] 	[256, 29, 29] 	4.08e-05
CONV4_1 	[256, 29, 29] 	[256, 512, 3, 3] 	[512, 29, 29] 	0.000297
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	4.59e-05
CONV4_2 	[512, 29, 29] 	[512, 512, 3, 3] 	[512, 29, 29] 	0.000531
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	4.69e-05
CONV4_3 	[512, 29, 29] 	[512, 512, 3, 3] 	[512, 29, 29] 	0.000531
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	4.64e-05
MPOOL 	[512, 29, 29] 	[0, 0, 2, 2] 	[512, 15, 15] 	4.2e-05
CONV5_1 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000361
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	4.79e-05
CONV5_2 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000357
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	4.73e-05
CONV5_3 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000358
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	4.62e-05
MPOOL 	[512, 15, 15] 	[0, 0, 2, 2] 	[512, 8, 8] 	4.13e-05
FC6 	[512, 8, 8] 	[512, 4096, 8, 8] 	[4096, 1, 1] 	0.00109
RELU 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	4.61e-05
DROPOUT 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	8.83e-05
FC7 	[4096, 1, 1] 	[4096, 4096, 1, 1] 	[4096, 1, 1] 	0.000151
RELU 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	4.24e-05
DROPOUT 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	7.89e-05
FC8 	[4096, 1, 1] 	[4096, 1000, 1, 1] 	[1000, 1, 1] 	9.58e-05
Total |x|: 29652556 items
Total |y|: 29500328 items
Total |w|: 169801408 items
Total comp: 0.0076177 items
Max |y|: 3268864 sec
226 64 3
==========SINGLE-NODE===============
maxBatchPerNode: 30.9401413463
mem4Sample: 1831634336.0
==========DATA PARALLELISM==========
maxBatchPerNode: 30.9401413463
mem4Sample: 1831634336.0
==========SPATIAL PARALLELISM==========
2048.0 1
max_rank 1
==========FILTER PARALLELISM==========
max_rank 64
Get result from Case 1 with miniBatch 32.0 nodeNumber 2.0
Not enough memory to store model and 64.0 samples in Filter-Parallelism with 4.0 GPUs
Not enough memory to store model and 128.0 samples in Filter-Parallelism with 8.0 GPUs
Not enough memory to store model and 256.0 samples in Filter-Parallelism with 16.0 GPUs
Not enough memory to store model and 512.0 samples in Filter-Parallelism with 32.0 GPUs
Not enough memory to store model and 1024.0 samples in Filter-Parallelism with 64.0 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 64.0
==========Channel PARALLELISM==========
max_rank 3
Get result from Case 1 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
==========Pipeline PARALLELISM==========
max_rank 38
---------- 2 --------
{'tin': 26635852, 'tcomp': 0.0035692, 'tout': 26913216, 'in': 153228, 'tw': 2913984, 'll': 18, 'fl': 0, 'id': 0, 'out': 430592}
{'tin': 3016704, 'tcomp': 0.004048500000000001, 'tout': 2587112, 'in': 430592, 'tw': 166887424, 'll': 37, 'fl': 19, 'id': 1, 'out': 1000}
---------- 4 --------
{'tin': 13228684, 'tcomp': 0.0017953999999999997, 'tout': 13892672, 'in': 153228, 'tw': 38592, 'll': 4, 'fl': 0, 'id': 0, 'out': 817216}
{'tin': 13407168, 'tcomp': 0.0017737999999999999, 'tout': 13020544, 'in': 817216, 'tw': 2875392, 'll': 18, 'fl': 5, 'id': 1, 'out': 430592}
{'tin': 2383360, 'tcomp': 0.0016062, 'tout': 2067968, 'in': 430592, 'tw': 7077888, 'll': 25, 'fl': 19, 'id': 2, 'out': 115200}
{'tin': 633344, 'tcomp': 0.0024423, 'tout': 519144, 'in': 115200, 'tw': 159809536, 'll': 37, 'fl': 26, 'id': 3, 'out': 1000}
---------- 8 --------
{'tin': 153228, 'tcomp': 0.00118, 'tout': 3268864, 'in': 153228, 'tw': 1728, 'll': 0, 'fl': 0, 'id': 0, 'out': 3268864}
{'tin': 15527104, 'tcomp': 0.0008318, 'tout': 13892672, 'in': 3268864, 'tw': 110592, 'll': 6, 'fl': 1, 'id': 1, 'out': 1634432}
{'tin': 7814400, 'tcomp': 0.0008597000000000001, 'tout': 7011712, 'in': 1634432, 'tw': 1032192, 'll': 13, 'fl': 7, 'id': 2, 'out': 831744}
{'tin': 3141120, 'tcomp': 0.0006977, 'tout': 2739968, 'in': 831744, 'tw': 1769472, 'll': 18, 'fl': 14, 'id': 3, 'out': 430592}
{'tin': 861184, 'tcomp': 0.0005779, 'tout': 861184, 'in': 430592, 'tw': 2359296, 'll': 20, 'fl': 19, 'id': 4, 'out': 430592}
{'tin': 1291776, 'tcomp': 0.0006194000000000001, 'tout': 976384, 'in': 430592, 'tw': 2359296, 'll': 23, 'fl': 21, 'id': 5, 'out': 115200}
{'tin': 460800, 'tcomp': 0.0008132, 'tout': 460800, 'in': 115200, 'tw': 4718592, 'll': 27, 'fl': 24, 'id': 6, 'out': 115200}
{'tin': 402944, 'tcomp': 0.002038, 'tout': 288744, 'in': 115200, 'tw': 157450240, 'll': 37, 'fl': 28, 'id': 7, 'out': 1000}
---------- 16 --------
{'tin': 153228, 'tcomp': 0.00118, 'tout': 3268864, 'in': 153228, 'tw': 1728, 'll': 0, 'fl': 0, 'id': 0, 'out': 3268864}
{'tin': 3268864, 'tcomp': 0.000215, 'tout': 3268864, 'in': 3268864, 'tw': 0, 'll': 1, 'fl': 1, 'id': 1, 'out': 3268864}
{'tin': 9806592, 'tcomp': 0.0004004, 'tout': 7354944, 'in': 3268864, 'tw': 36864, 'll': 4, 'fl': 2, 'id': 2, 'out': 817216}
{'tin': 4086080, 'tcomp': 0.0004524, 'tout': 4903296, 'in': 817216, 'tw': 221184, 'll': 7, 'fl': 5, 'id': 3, 'out': 1634432}
{'tin': 4516480, 'tcomp': 0.00031009999999999995, 'tout': 3713792, 'in': 1634432, 'tw': 294912, 'll': 11, 'fl': 8, 'id': 4, 'out': 831744}
{'tin': 1663488, 'tcomp': 0.00031360000000000003, 'tout': 1663488, 'in': 831744, 'tw': 589824, 'll': 13, 'fl': 12, 'id': 5, 'out': 831744}
{'tin': 2495232, 'tcomp': 0.0003548, 'tout': 1878784, 'in': 831744, 'tw': 589824, 'll': 16, 'fl': 14, 'id': 6, 'out': 215296}
{'tin': 645888, 'tcomp': 0.0003429, 'tout': 861184, 'in': 215296, 'tw': 1179648, 'll': 18, 'fl': 17, 'id': 7, 'out': 430592}
{'tin': 430592, 'tcomp': 0.000531, 'tout': 430592, 'in': 430592, 'tw': 2359296, 'll': 19, 'fl': 19, 'id': 8, 'out': 430592}
{'tin': 430592, 'tcomp': 4.69e-05, 'tout': 430592, 'in': 430592, 'tw': 0, 'll': 20, 'fl': 20, 'id': 9, 'out': 430592}
{'tin': 430592, 'tcomp': 0.000531, 'tout': 430592, 'in': 430592, 'tw': 2359296, 'll': 21, 'fl': 21, 'id': 10, 'out': 430592}
{'tin': 976384, 'tcomp': 0.0004494, 'tout': 660992, 'in': 430592, 'tw': 2359296, 'll': 24, 'fl': 22, 'id': 11, 'out': 115200}
{'tin': 345600, 'tcomp': 0.00045220000000000004, 'tout': 345600, 'in': 115200, 'tw': 2359296, 'll': 27, 'fl': 25, 'id': 12, 'out': 115200}
{'tin': 345600, 'tcomp': 0.00044549999999999993, 'tout': 263168, 'in': 115200, 'tw': 2359296, 'll': 30, 'fl': 28, 'id': 13, 'out': 32768}
{'tin': 32768, 'tcomp': 0.00109, 'tout': 4096, 'in': 32768, 'tw': 134217728, 'll': 31, 'fl': 31, 'id': 14, 'out': 4096}
{'tin': 24576, 'tcomp': 0.0005024999999999999, 'tout': 21480, 'in': 4096, 'tw': 20873216, 'll': 37, 'fl': 32, 'id': 15, 'out': 1000}
---------- 32 --------
Cannot split model into 32 partitions using average method. Use naive method instead
{'tin': 153228, 'tcomp': 0.00118, 'tout': 3268864, 'in': 153228, 'tw': 1728, 'll': 0, 'fl': 0, 'id': 0, 'out': 3268864}
{'tin': 3268864, 'tcomp': 0.000215, 'tout': 3268864, 'in': 3268864, 'tw': 0, 'll': 1, 'fl': 1, 'id': 1, 'out': 3268864}
{'tin': 3268864, 'tcomp': 0.000269, 'tout': 3268864, 'in': 3268864, 'tw': 36864, 'll': 2, 'fl': 2, 'id': 2, 'out': 3268864}
{'tin': 6537728, 'tcomp': 0.0001314, 'tout': 4086080, 'in': 3268864, 'tw': 0, 'll': 4, 'fl': 3, 'id': 3, 'out': 817216}
{'tin': 2451648, 'tcomp': 0.0002164, 'tout': 3268864, 'in': 817216, 'tw': 73728, 'll': 6, 'fl': 5, 'id': 4, 'out': 1634432}
{'tin': 1634432, 'tcomp': 0.000236, 'tout': 1634432, 'in': 1634432, 'tw': 147456, 'll': 7, 'fl': 7, 'id': 5, 'out': 1634432}
{'tin': 3268864, 'tcomp': 9.669999999999999e-05, 'tout': 2050304, 'in': 1634432, 'tw': 0, 'll': 9, 'fl': 8, 'id': 6, 'out': 415872}
{'tin': 1247616, 'tcomp': 0.00021339999999999998, 'tout': 1663488, 'in': 415872, 'tw': 294912, 'll': 11, 'fl': 10, 'id': 7, 'out': 831744}
{'tin': 831744, 'tcomp': 0.000268, 'tout': 831744, 'in': 831744, 'tw': 589824, 'll': 12, 'fl': 12, 'id': 8, 'out': 831744}
{'tin': 831744, 'tcomp': 4.56e-05, 'tout': 831744, 'in': 831744, 'tw': 0, 'll': 13, 'fl': 13, 'id': 9, 'out': 831744}
{'tin': 831744, 'tcomp': 0.000268, 'tout': 831744, 'in': 831744, 'tw': 589824, 'll': 14, 'fl': 14, 'id': 10, 'out': 831744}
{'tin': 1663488, 'tcomp': 8.68e-05, 'tout': 1047040, 'in': 831744, 'tw': 0, 'll': 16, 'fl': 15, 'id': 11, 'out': 215296}
{'tin': 215296, 'tcomp': 0.000297, 'tout': 430592, 'in': 215296, 'tw': 1179648, 'll': 17, 'fl': 17, 'id': 12, 'out': 430592}
{'tin': 430592, 'tcomp': 4.59e-05, 'tout': 430592, 'in': 430592, 'tw': 0, 'll': 18, 'fl': 18, 'id': 13, 'out': 430592}
{'tin': 430592, 'tcomp': 0.000531, 'tout': 430592, 'in': 430592, 'tw': 2359296, 'll': 19, 'fl': 19, 'id': 14, 'out': 430592}
{'tin': 430592, 'tcomp': 4.69e-05, 'tout': 430592, 'in': 430592, 'tw': 0, 'll': 20, 'fl': 20, 'id': 15, 'out': 430592}
{'tin': 430592, 'tcomp': 0.000531, 'tout': 430592, 'in': 430592, 'tw': 2359296, 'll': 21, 'fl': 21, 'id': 16, 'out': 430592}
{'tin': 861184, 'tcomp': 8.840000000000001e-05, 'tout': 545792, 'in': 430592, 'tw': 0, 'll': 23, 'fl': 22, 'id': 17, 'out': 115200}
{'tin': 115200, 'tcomp': 0.000361, 'tout': 115200, 'in': 115200, 'tw': 2359296, 'll': 24, 'fl': 24, 'id': 18, 'out': 115200}
{'tin': 115200, 'tcomp': 4.79e-05, 'tout': 115200, 'in': 115200, 'tw': 0, 'll': 25, 'fl': 25, 'id': 19, 'out': 115200}
{'tin': 115200, 'tcomp': 0.000357, 'tout': 115200, 'in': 115200, 'tw': 2359296, 'll': 26, 'fl': 26, 'id': 20, 'out': 115200}
{'tin': 115200, 'tcomp': 4.73e-05, 'tout': 115200, 'in': 115200, 'tw': 0, 'll': 27, 'fl': 27, 'id': 21, 'out': 115200}
{'tin': 115200, 'tcomp': 0.000358, 'tout': 115200, 'in': 115200, 'tw': 2359296, 'll': 28, 'fl': 28, 'id': 22, 'out': 115200}
{'tin': 230400, 'tcomp': 8.75e-05, 'tout': 147968, 'in': 115200, 'tw': 0, 'll': 30, 'fl': 29, 'id': 23, 'out': 32768}
{'tin': 32768, 'tcomp': 0.00109, 'tout': 4096, 'in': 32768, 'tw': 134217728, 'll': 31, 'fl': 31, 'id': 24, 'out': 4096}
{'tin': 8192, 'tcomp': 0.00013440000000000001, 'tout': 8192, 'in': 4096, 'tw': 0, 'll': 33, 'fl': 32, 'id': 25, 'out': 4096}
{'tin': 8192, 'tcomp': 0.0001934, 'tout': 8192, 'in': 4096, 'tw': 16777216, 'll': 35, 'fl': 34, 'id': 26, 'out': 4096}
{'tin': 0, 'tcomp': 0, 'tout': 0, 'in': 4096, 'tw': 0, 'll': -1, 'fl': 36, 'id': 27, 'out': 1000}
{'tin': 4096, 'tcomp': 9.58e-05, 'tout': 1000, 'in': 4096, 'tw': 4096000, 'll': -1, 'fl': -1, 'id': 28, 'out': 1000}
{'tin': 4096, 'tcomp': 9.58e-05, 'tout': 1000, 'in': 4096, 'tw': 4096000, 'll': -1, 'fl': -1, 'id': 29, 'out': 1000}
{'tin': 4096, 'tcomp': 9.58e-05, 'tout': 1000, 'in': 4096, 'tw': 4096000, 'll': -1, 'fl': -1, 'id': 30, 'out': 1000}
{'tin': 57344, 'tcomp': 0.0015925000000000002, 'tout': 25576, 'in': 32768, 'tw': 155090944, 'll': 37, 'fl': 31, 'id': 31, 'out': 1000}
==========DATA + FILTER PARALLELISM==========
maxBatchPerNode: 33.093055074
mem4Sample: 812825888.0
====================================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
single		16.0	1	8929980416.0	9750.656	0	9750.656	163.0
data		32.0	2.0	8929980416.0	4875.328	544.0845056	5419.4125056	182.0
data		64.0	4.0	8929980416.0	2437.664	408.6033792	2846.2673792	192.0
data		128.0	8.0	8929980416.0	1218.832	953.0312848	2171.8632848	296.0
data		256.0	16.0	8929980416.0	609.416	511.700724	1121.116724	304.0
data		512.0	32.0	8929980416.0	304.708	265.5652324	570.2732324	320.0
data		1024.0	64.0	8929980416.0	152.354	136.1299338	288.4839338	320.0
data		2048.0	128.0	8929980416.0	76.177	69.8489713	146.0259713	384.0
data		4096.0	256.0	8929980416.0	38.0885	36.37443675	74.46293675	512.0
data		8192.0	512.0	8929980416.0	19.04425	19.4987827125	38.5430327125	512.0
data		16384.0	1024.0	8929980416.0	9.522125	11.0360824406	20.5582074406	1024.0
data		32768.0	2048.0	8929980416.0	4.7610625	6.79851399141	11.5595764914	2048.0
filter		32.0	2.0	15822343936.0	4875.328	4571.0567808	9446.3847808	316.0
filter		32.0	2.0	15822343936.0	4875.328	4571.0567808	9446.3847808	316.0
filter		32.0	4.0	15482741120.0	2437.664	6916.5251712	9354.1891712	624.0
filter		32.0	8.0	15312939712.0	1218.832	32193.5122656	33412.3442656	4456.0
filter		32.0	16.0	15228039008.0	609.416	35002.871856	35612.287856	9504.0
filter		32.0	32.0	15185588656.0	304.708	37223.2684512	37527.9764512	20032.0
filter		32.0	64.0	15164363480.0	152.354	39964.9003488	40117.2543488	42816.0
channel		32.0	2.0	15822343936.0	4875.328	4571.0567808	9446.3847808	316.0
channel		32.0	2.0	15822343936.0	4875.328	4571.0567808	9446.3847808	316.0
pipe		32.0	2	6877592576.0	7773.12	89.6252416	7862.7452416	264.0
pipe		64.0	4	3471842304.0	5470.752	253.2087552	5723.9607552	384.0
pipe		128.0	8	3766616064.0	4891.2	1174.0808576	6065.2808576	816.0
pipe		256.0	16	2196971520.0	2926.4	2515.080552	5441.480552	1456.0
pipe		512.0	32	1359847424.0	4013.1	2598.9165704	6612.0165704	3552.0
dfilter		64.0	4.0	7911171968.0	2437.664	6856.5851712	9294.2491712	620.0
dfilter		128.0	8.0	7911171968.0	1218.832	3971.9632912	5190.7952912	696.0
dfilter		256.0	16.0	7911171968.0	609.416	2122.128972	2731.544972	736.0
dfilter		512.0	32.0	7911171968.0	304.708	1095.3309676	1400.0389676	768.0
dfilter		1024.0	64.0	7911171968.0	152.354	556.4617542	708.8157542	768.0
dfilter		2048.0	128.0	7911171968.0	76.177	280.6665697	356.8435697	768.0
dfilter		4096.0	256.0	7911171968.0	38.0885	141.193008	179.281508	768.0
dfilter		8192.0	512.0	7911171968.0	19.04425	71.04876135	90.09301135	1024.0
dfilter		16384.0	1024.0	7911171968.0	9.522125	35.8771450125	45.3992700125	1024.0
dfilter		32768.0	2048.0	7911171968.0	4.7610625	18.2664635906	23.0275260906	2048.0
dfilter		32.0	4.0	15482741120.0	2437.664	6916.5251712	9354.1891712	624.0
dfilter		64.0	8.0	15482741120.0	1218.832	4545.6039968	5764.4359968	776.0
dfilter		128.0	16.0	15482741120.0	609.416	2545.0966512	3154.5126512	848.0
dfilter		256.0	32.0	15482741120.0	304.708	1341.0812888	1645.7892888	896.0
dfilter		512.0	64.0	15482741120.0	152.354	688.1331852	840.4871852	960.0
dfilter		1024.0	128.0	15482741120.0	76.177	348.9379778	425.1149778	1024.0
dfilter		2048.0	256.0	15482741120.0	38.0885	176.1884352	214.2769352	1024.0
dfilter		4096.0	512.0	15482741120.0	19.04425	88.9987323	108.0429823	1024.0
dfilter		8192.0	1024.0	15482741120.0	9.522125	45.204894825	54.727019825	1024.0
dfilter		16384.0	2048.0	15482741120.0	4.7610625	23.2582295812	28.0192920813	2048.0

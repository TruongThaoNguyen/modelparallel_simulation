#######################################################
-net ./ALEXNET_ImageNet.net -plat ABCI.plat -goal 1 --paratype ['a']
--cmaxB 524288.0 --cmaxp 2048.0 --cBon 512.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./ALEXNET_ImageNet.net
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  AlexNet
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV1 	[3, 226, 226] = 153228 	[3, 96, 11, 11] = 34848 	[96, 54, 54] = 279936 	5.21156307692e-05
1 RELU 	[96, 54, 54] = 279936 	[96, 96, 0, 0] = 0 	[96, 54, 54] = 279936 	7.17784615385e-08
2 MPOOL 	[96, 54, 54] = 279936 	[0, 0, 3, 3] = 0 	[96, 27, 27] = 69984 	1.55041476923e-05
3 CONV2 	[96, 27, 27] = 69984 	[96, 256, 5, 5] = 614400 	[256, 27, 27] = 186624 	0.000229769846154
4 RELU 	[256, 27, 27] = 186624 	[256, 256, 0, 0] = 0 	[256, 27, 27] = 186624 	4.78523076923e-08
5 MPOOL 	[256, 27, 27] = 186624 	[0, 0, 3, 3] = 0 	[256, 13, 13] = 43264 	2.555904e-05
6 CONV3 	[256, 13, 13] = 43264 	[256, 384, 3, 3] = 884736 	[384, 13, 13] = 64896 	7.67905476923e-05
7 RELU 	[384, 13, 13] = 64896 	[384, 384, 0, 0] = 0 	[384, 13, 13] = 64896 	1.664e-08
8 CONV4 	[384, 13, 13] = 64896 	[384, 384, 3, 3] = 1327104 	[384, 13, 13] = 64896 	0.000115185821538
9 RELU 	[384, 13, 13] = 64896 	[384, 384, 0, 0] = 0 	[384, 13, 13] = 64896 	1.664e-08
10 CONV5 	[384, 13, 13] = 64896 	[384, 256, 3, 3] = 884736 	[256, 13, 13] = 43264 	7.67905476923e-05
11 RELU 	[256, 13, 13] = 43264 	[256, 256, 0, 0] = 0 	[256, 13, 13] = 43264 	1.10933333333e-08
12 MPOOL 	[256, 13, 13] = 43264 	[0, 0, 3, 3] = 0 	[256, 6, 6] = 9216 	5.44452923077e-06
13 FC6 	[256, 6, 6] = 9216 	[256, 4096, 6, 6] = 37748736 	[4096, 1, 1] = 4096 	1.45187446154e-05
14 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	1.05025641026e-09
15 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
16 FC7 	[4096, 1, 1] = 4096 	[4096, 4096, 1, 1] = 16777216 	[4096, 1, 1] = 4096 	6.45277538462e-06
17 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	1.05025641026e-09
18 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
19 FC8 	[4096, 1, 1] = 4096 	[4096, 1000, 1, 1] = 4096000 	[1000, 1, 1] = 1000 	1.57538461538e-06
Model with 20 layers
Total |x|: 931692 items
Total |y|: 779464 items
Total |w|: 62367776 items
Total comp: 0.00061987312 sec
Max comp: 0.000229769846154 sec ==>1613.23336621samples for 100% GPU ultilization
Max |y|: 279936 items
****
global value g GOAL 1
MAX_MINIBATCH 524288.0
MAX_RANK 2048.0
FIX_MIRCO_BATCH 512.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1280000.0
GPU_PER_NODE 4

{'maxOut': 279936, 'totalOut': 779464, 'minFilter': 96, 'minChannel': 3, 'totalIn': 931692, 'totalComp': 0.0006198731199999999, 'totalWeight': 62367776, 'minW': 1}
==========SINGLE-NODE===============
maxSamplePerNode: 1132.35276269
Use FIX_MIRCO_BATCH set by user for miniBatch:  512.0
==========DATA PARALLELISM==========
maxSamplePerNode: 1132.35276269
Use FIX_MIRCO_BATCH set by user,  512.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
512.0 1711156 62367776 4.0
==========SPATIAL PARALLELISM==========
max_rank 6
maxSamplePerNode: 2734.91449864
Use FIX_MIRCO_BATCH set by user,  512.0
2.0 7.35011446154e-05
maxSamplePerNode: 3602.08251041
Use FIX_MIRCO_BATCH set by user,  512.0
4.0 5.58064246154e-05
==========FILTER PARALLELISM==========
max_rank 96
Get result from Case 1 with miniBatch 1024.0 nodeNumber 2.0
Not enough memory to store model and 2048.0 samples in Filter-Parallelism with 4.0 GPUs
Not enough memory to store model and 4096.0 samples in Filter-Parallelism with 8.0 GPUs
Not enough memory to store model and 8192.0 samples in Filter-Parallelism with 16.0 GPUs
Not enough memory to store model and 16384.0 samples in Filter-Parallelism with 32.0 GPUs
Not enough memory to store model and 32768.0 samples in Filter-Parallelism with 64.0 GPUs
Get result from Case 2 with miniBatch 1024.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 1024.0 nodeNumber 4.0
Get result from Case 2 with miniBatch 1024.0 nodeNumber 8.0
Get result from Case 2 with miniBatch 1024.0 nodeNumber 16.0
Get result from Case 2 with miniBatch 1024.0 nodeNumber 32.0
Get result from Case 2 with miniBatch 1024.0 nodeNumber 64.0
maxSamplePerNode: 1168.23101079
Use FIX_MIRCO_BATCH set by user,  512.0
Get result from Case 3 with miniBatch 512.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 512.0 nodeNumber 4.0
Get result from Case 3 with miniBatch 512.0 nodeNumber 8.0
Get result from Case 3 with miniBatch 512.0 nodeNumber 16.0
Get result from Case 3 with miniBatch 512.0 nodeNumber 32.0
Get result from Case 3 with miniBatch 512.0 nodeNumber 64.0
==========Channel PARALLELISM==========
max_rank 3
1
Get result from Case 1 with miniBatch 1024.0 nodeNumber 2.0
Not enough memory to store model and 1536.0 samples in Channel-Parallelism with 3 GPUs
Get result from Case 2 with miniBatch 1024.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 1024.0 nodeNumber 3
maxSamplePerNode: 1156.65125876
Use FIX_MIRCO_BATCH set by user,  512.0
Get result from Case 3 with miniBatch 512.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 512.0 nodeNumber 3
==========DATA + FILTER PARALLELISM==========
Use FIX_MIRCO_BATCH set by user,  512.0
==========DATA + SPATIAL PARALLELISM==========
max_rank 6
maxSamplePerNode: 3602.08251041
Use FIX_MIRCO_BATCH set by user,  512.0
4.0 5.58064246154e-05
8.0 5.58064246154e-05
16.0 5.58064246154e-05
32.0 5.58064246154e-05
64.0 5.58064246154e-05
128.0 5.58064246154e-05
256.0 5.58064246154e-05
512.0 5.58064246154e-05
1024.0 5.58064246154e-05
2048.0 5.58064246154e-05
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
single		512.0	1	7507837184.0	793.4375936	0	793.4375936	14.0
data		1024.0	2.0	7507837184.0	396.7187968	6.2592776	402.9780744	14.0
data		2048.0	4.0	7507837184.0	198.3593984	4.7113332	203.0707316	16.0
data		4096.0	8.0	7507837184.0	99.1796992	11.0646421973	110.244341397	16.0
data		8192.0	16.0	7507837184.0	49.5898496	6.0178045992	55.6076541992	16.0
data		16384.0	32.0	7507837184.0	24.7949248	3.20323204848	27.9981568485	32.0
data		32768.0	64.0	7507837184.0	12.3974624	1.7244303552	14.1218927552	64.0
data		65536.0	128.0	7507837184.0	6.1987312	0.9469599552	7.1456911552	128.0
data		131072.0	256.0	7507837184.0	3.0993656	0.555592572	3.654958172	256.0
data		262144.0	512.0	7507837184.0	1.5496828	0.3574948846	1.9071776846	512.0
data		524288.0	1024.0	7507837184.0	0.7748414	0.30978443034	1.08462583034	1024.0
spatial		512.0	2.0	3400876288.0	94.0814651077	14.6785984	108.760063508	4.0
spatial		512.0	4.0	2702262528.0	71.4322235077	21.5672352	92.9994587077	8.0
filter1		1024.0	2.0	14267261056.0	396.7187968	120.2133204	516.9321172	18.0
filter2		1024.0	2.0	14267261056.0	396.7187968	120.2133204	516.9321172	18.0
filter2		1024.0	4.0	14142525504.0	198.3593984	181.2818556	379.641254	28.0
filter2		1024.0	8.0	14080157728.0	99.1796992	852.1216053	951.3013045	128.0
filter2		1024.0	16.0	14048973840.0	49.5898496	929.1843405	978.7741901	272.0
filter2		1024.0	32.0	14033381896.0	24.7949248	993.6307581	1018.4256829	544.0
filter2		1024.0	64.0	14025585924.0	12.3974624	1077.6840669	1090.0815293	1216.0
filter3		512.0	2.0	7258366080.0	396.7187968	120.8545704	517.5733672	18.0
filter3		512.0	4.0	7133630528.0	198.3593984	183.2056056	381.565004	28.0
filter3		512.0	8.0	7071262752.0	99.1796992	867.2387178	966.418417	136.0
filter3		512.0	16.0	7040078864.0	49.5898496	961.578153	1011.1680026	272.0
filter3		512.0	32.0	7024486920.0	24.7949248	1060.5779706	1085.3728954	608.0
filter3		512.0	64.0	7016690948.0	12.3974624	1213.7380794	1226.1355418	1344.0
chan1		1024.0	2.0	14267261056.0	396.7187968	120.2133204	516.9321172	18.0
chan2		1024.0	2.0	14267261056.0	396.7187968	120.2133204	516.9321172	18.0
chan2		1024.0	3	14184104021.3	264.479404491	160.7119272	425.191331691	24.0
chan3		512.0	2.0	7258366080.0	396.7187968	120.8545704	517.5733672	18.0
chan3		512.0	3	7175209045.33	264.479404491	161.9944272	426.473831691	24.0
df		512.0	4.0	7133630528.0	198.3593984	183.2056056	381.565004	28.0
df		1024.0	8.0	7133630528.0	99.1796992	116.6256882	215.8053874	32.0
df		2048.0	16.0	7133630528.0	49.5898496	64.6253967	114.2152463	32.0
df		4096.0	32.0	7133630528.0	24.7949248	34.0019840184	58.7969088184	32.0
df		8192.0	64.0	7133630528.0	12.3974624	17.5231166309	29.9205790309	64.0
df		16384.0	128.0	7133630528.0	6.1987312	8.99341082544	15.1921420254	128.0
df		32768.0	256.0	7133630528.0	3.0993656	4.6590968448	7.7584624448	256.0
df		65536.0	512.0	7133630528.0	1.5496828	2.415094	3.9647768	512.0
df		131072.0	1024.0	7133630528.0	0.7748414	1.2884149944	2.0632563944	1024.0
df		262144.0	2048.0	7133630528.0	0.3874207	0.7239060958	1.1113267958	2048.0
ds		512.0	4.0	2702262528.0	71.4322235077	21.5672352	92.9994587077	8.0
ds		1024.0	8.0	2702262528.0	35.7161117538	110.6478342	146.363945954	24.0
ds		2048.0	16.0	2702262528.0	17.8580558769	80.3468025	98.2048583769	32.0
ds		4096.0	32.0	2702262528.0	8.92902793846	46.5603313762	55.4893593146	32.0
ds		8192.0	64.0	2702262528.0	4.46451396923	24.9973604674	29.4618744366	64.0
ds		16384.0	128.0	2702262528.0	2.23225698462	13.0499593262	15.2822163109	128.0
ds		32768.0	256.0	2702262528.0	1.11612849231	6.787886784	7.90401527631	256.0
ds		65536.0	512.0	2702262528.0	0.558064246154	3.4981993024	4.05626354855	512.0
ds		131072.0	1024.0	2702262528.0	0.279032123077	1.8346452288	2.11367735188	1024.0
ds		262144.0	2048.0	2702262528.0	0.139516061538	0.9981906088	1.13770667034	2048.0

#######################################################
-net ./VGG_ImageNet_prof.net1 -plat ABCI.plat -goal 1 --paratype ['a']
--cmaxB 262144.0 --cmaxp 2048.0 --cBon 32.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./VGG_ImageNet_prof.net1
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV1_1 	[3, 226, 226] = 153228 	[3, 64, 3, 3] = 1728 	[64, 226, 226] = 3268864 	0.02629169
1 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
2 CONV1_2 	[64, 226, 226] = 3268864 	[64, 64, 3, 3] = 36864 	[64, 226, 226] = 3268864 	0.0
3 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
4 MPOOL 	[64, 226, 226] = 3268864 	[0, 0, 2, 2] = 0 	[64, 113, 113] = 817216 	0.0
5 CONV2_1 	[64, 113, 113] = 817216 	[64, 128, 3, 3] = 73728 	[128, 113, 113] = 1634432 	0.0
6 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
7 CONV2_2 	[128, 113, 113] = 1634432 	[128, 128, 3, 3] = 147456 	[128, 113, 113] = 1634432 	0.0
8 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
9 MPOOL 	[128, 113, 113] = 1634432 	[0, 0, 2, 2] = 0 	[128, 57, 57] = 415872 	0.0
10 CONV3_1 	[128, 57, 57] = 415872 	[128, 256, 3, 3] = 294912 	[256, 57, 57] = 831744 	0.0
11 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
12 CONV3_2 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
13 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
14 CONV3_3 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
15 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
16 MPOOL 	[256, 57, 57] = 831744 	[0, 0, 2, 2] = 0 	[256, 29, 29] = 215296 	0.0
17 CONV4_1 	[256, 29, 29] = 215296 	[256, 512, 3, 3] = 1179648 	[512, 29, 29] = 430592 	0.0
18 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
19 CONV4_2 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
20 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
21 CONV4_3 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
22 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
23 MPOOL 	[512, 29, 29] = 430592 	[0, 0, 2, 2] = 0 	[512, 15, 15] = 115200 	0.0
24 CONV5_1 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
25 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
26 CONV5_2 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
27 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
28 CONV5_3 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
29 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
30 MPOOL 	[512, 15, 15] = 115200 	[0, 0, 2, 2] = 0 	[512, 8, 8] = 32768 	0.0
31 FC6 	[512, 8, 8] = 32768 	[512, 4096, 8, 8] = 134217728 	[4096, 1, 1] = 4096 	0.0
32 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
33 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
34 FC7 	[4096, 1, 1] = 4096 	[4096, 4096, 1, 1] = 16777216 	[4096, 1, 1] = 4096 	0.0
35 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
36 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
37 FC8 	[4096, 1, 1] = 4096 	[4096, 1000, 1, 1] = 4096000 	[1000, 1, 1] = 1000 	0.0
Model with 38 layers
Total |x|: 15705164 items
Total |y|: 15552936 items
Total |w|: 169801408 items
Total comp: 0.02629169 sec
Max comp: 0.02629169 sec ==>38.034831538samples for 100% GPU ultilization
Max |y|: 3268864 items
****
global value g GOAL 1
MAX_MINIBATCH 262144.0
MAX_RANK 2048.0
FIX_MIRCO_BATCH 32.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1280000.0
GPU_PER_NODE 4

{'maxOut': 3268864, 'totalOut': 15552936, 'minFilter': 64, 'minChannel': 3, 'totalIn': 15705164, 'totalComp': 0.02629169, 'totalWeight': 169801408, 'minW': 1}
==========SINGLE-NODE===============
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user for miniBatch:  32.0
==========DATA PARALLELISM==========
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user,  32.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
==========SPATIAL PARALLELISM==========
max_rank 8
maxSamplePerNode: 549.728046905
Use FIX_MIRCO_BATCH set by user,  32.0
2.0 0.0
maxSamplePerNode: 838.568207143
Use FIX_MIRCO_BATCH set by user,  32.0
4.0 0.0
maxSamplePerNode: 1137.36837291
Use FIX_MIRCO_BATCH set by user,  32.0
8.0 0.0
==========FILTER PARALLELISM==========
max_rank 64
Not enough memory to store model and 64.0 samples in Filter-Parallelism with 2.0 GPUs
Not enough memory to store model and 128.0 samples in Filter-Parallelism with 4.0 GPUs
Not enough memory to store model and 256.0 samples in Filter-Parallelism with 8.0 GPUs
Not enough memory to store model and 512.0 samples in Filter-Parallelism with 16.0 GPUs
Not enough memory to store model and 1024.0 samples in Filter-Parallelism with 32.0 GPUs
Not enough memory to store model and 2048.0 samples in Filter-Parallelism with 64.0 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 64.0
maxSamplePerNode: 63.8985367953
Use FIX_MIRCO_BATCH set by user,  32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 64.0
==========Channel PARALLELISM==========
max_rank 3
1
Not enough memory to store model and 64.0 samples in Channel-Parallelism with 2.0 GPUs
Not enough memory to store model and 96.0 samples in Channel-Parallelism with 3 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 3
maxSamplePerNode: 62.1726698253
Use FIX_MIRCO_BATCH set by user,  32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 3
==========DATA + FILTER PARALLELISM==========
Use FIX_MIRCO_BATCH set by user,  32.0
==========DATA + SPATIAL PARALLELISM==========
max_rank 8
maxSamplePerNode: 838.568207143
Use FIX_MIRCO_BATCH set by user,  32.0
4.0 0.0
8.0 0.0
16.0 0.0
32.0 0.0
64.0 0.0
128.0 0.0
256.0 0.0
512.0 0.0
1024.0 0.0
2048.0 0.0
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
single		32.0	1	9360484864.0	33653.3632	0	33653.3632	561.0
data		64.0	2.0	9360484864.0	16826.6816	272.0422528	17098.7238528	570.0
data		128.0	4.0	9360484864.0	8413.3408	204.3016896	8617.6424896	576.0
data		256.0	8.0	9360484864.0	4206.6704	477.5656424	4684.2360424	632.0
data		512.0	16.0	9360484864.0	2103.3352	256.975362	2360.310562	640.0
data		1024.0	32.0	9360484864.0	1051.6676	133.9451162	1185.6127162	640.0
data		2048.0	64.0	9360484864.0	525.8338	69.2462169	595.0800169	640.0
data		4096.0	128.0	9360484864.0	262.9169	36.172894827	299.089794827	640.0
data		8192.0	256.0	9360484864.0	131.45845	19.4755670232	150.934017023	768.0
data		16384.0	512.0	9360484864.0	65.729225	11.0696545394	76.7988795394	1024.0
data		32768.0	1024.0	9360484864.0	32.8646125	6.8780742096	39.7426867096	1024.0
data		65536.0	2048.0	9360484864.0	16.43230625	4.7090391636	21.1413454136	2048.0
spatial		32.0	2.0	2210706944.0	0.0	592.8250624	592.8250624	20.0
spatial		32.0	4.0	1917138432.0	0.0	869.0650368	869.0650368	60.0
spatial		32.0	8.0	1770354176.0	0.0	4011.424896	4011.424896	536.0
filter2		32.0	2.0	8681279232.0	16826.6816	2428.7373696	19255.4189696	642.0
filter2		32.0	4.0	8341676416.0	8413.3408	3703.0460544	12116.3868544	808.0
filter2		32.0	8.0	8171875008.0	4206.6704	17663.4763872	21870.1467872	2920.0
filter2		32.0	16.0	8086974304.0	2103.3352	19934.476272	22037.811472	5888.0
filter2		32.0	32.0	8044523952.0	1051.6676	22684.8930144	23736.5606144	12672.0
filter2		32.0	64.0	8023298776.0	525.8338	27289.9349856	27815.7687856	29696.0
filter3		32.0	2.0	8681279232.0	16826.6816	2428.7373696	19255.4189696	642.0
filter3		32.0	4.0	8341676416.0	8413.3408	3703.0460544	12116.3868544	808.0
filter3		32.0	8.0	8171875008.0	4206.6704	17663.4763872	21870.1467872	2920.0
filter3		32.0	16.0	8086974304.0	2103.3352	19934.476272	22037.811472	5888.0
filter3		32.0	32.0	8044523952.0	1051.6676	22684.8930144	23736.5606144	12672.0
filter3		32.0	64.0	8023298776.0	525.8338	27289.9349856	27815.7687856	29696.0
chan2		32.0	2.0	8681279232.0	16826.6816	2428.7373696	19255.4189696	642.0
chan2		32.0	3	8454877354.67	11217.7964972	3264.9564928	14482.75299	726.0
chan3		32.0	2.0	8681279232.0	16826.6816	2428.7373696	19255.4189696	642.0
chan3		32.0	3	8454877354.67	11217.7964972	3264.9564928	14482.75299	726.0
df		32.0	4.0	8341676416.0	8413.3408	3703.0460544	12116.3868544	808.0
df		64.0	8.0	8341676416.0	4206.6704	2939.4644384	7146.1348384	960.0
df		128.0	16.0	8341676416.0	2103.3352	1742.626872	3845.962072	1040.0
df		256.0	32.0	8341676416.0	1051.6676	940.4463992	1992.1139992	1088.0
df		512.0	64.0	8341676416.0	525.8338	488.4157404	1014.2495404	1088.0
df		1024.0	128.0	8341676416.0	262.9169	249.6792554	512.5961554	1152.0
df		2048.0	256.0	8341676416.0	131.45845	127.159074	258.617524	1280.0
df		4096.0	512.0	8341676416.0	65.729225	65.1881861827	130.917411183	1536.0
df		8192.0	1024.0	8341676416.0	32.8646125	34.0100227867	66.8746352867	2048.0
df		16384.0	2048.0	8341676416.0	16.43230625	18.3831704969	34.8154767469	2048.0
ds		32.0	4.0	1917138432.0	0.0	869.0650368	869.0650368	60.0
ds		64.0	8.0	1917138432.0	0.0	4782.6609632	4782.6609632	640.0
ds		128.0	16.0	1917138432.0	0.0	3479.2718928	3479.2718928	928.0
ds		256.0	32.0	1917138432.0	0.0	2012.5305992	2012.5305992	1088.0
ds		512.0	64.0	1917138432.0	0.0	1075.3982628	1075.3982628	1152.0
ds		1024.0	128.0	1917138432.0	0.0	555.9056222	555.9056222	1280.0
ds		2048.0	256.0	1917138432.0	0.0	283.4560338	283.4560338	1280.0
ds		4096.0	512.0	1917138432.0	0.0	144.258921261	144.258921261	1536.0
ds		8192.0	1024.0	1917138432.0	0.0	73.8716425622	73.8716425622	2048.0
ds		16384.0	2048.0	1917138432.0	0.0	38.4912318854	38.4912318854	2048.0
==================================Below is the result of using min comp of iter=======================================
#######################################################
-net ./VGG_ImageNet_prof.net1 -plat ABCI.plat -goal 1 --paratype ['a']
--cmaxB 262144.0 --cmaxp 2048.0 --cBon 32.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./VGG_ImageNet_prof.net1
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV1_1 	[3, 226, 226] = 153228 	[3, 64, 3, 3] = 1728 	[64, 226, 226] = 3268864 	0.000526056
1 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
2 CONV1_2 	[64, 226, 226] = 3268864 	[64, 64, 3, 3] = 36864 	[64, 226, 226] = 3268864 	0.0
3 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
4 MPOOL 	[64, 226, 226] = 3268864 	[0, 0, 2, 2] = 0 	[64, 113, 113] = 817216 	0.0
5 CONV2_1 	[64, 113, 113] = 817216 	[64, 128, 3, 3] = 73728 	[128, 113, 113] = 1634432 	0.0
6 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
7 CONV2_2 	[128, 113, 113] = 1634432 	[128, 128, 3, 3] = 147456 	[128, 113, 113] = 1634432 	0.0
8 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
9 MPOOL 	[128, 113, 113] = 1634432 	[0, 0, 2, 2] = 0 	[128, 57, 57] = 415872 	0.0
10 CONV3_1 	[128, 57, 57] = 415872 	[128, 256, 3, 3] = 294912 	[256, 57, 57] = 831744 	0.0
11 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
12 CONV3_2 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
13 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
14 CONV3_3 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
15 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
16 MPOOL 	[256, 57, 57] = 831744 	[0, 0, 2, 2] = 0 	[256, 29, 29] = 215296 	0.0
17 CONV4_1 	[256, 29, 29] = 215296 	[256, 512, 3, 3] = 1179648 	[512, 29, 29] = 430592 	0.0
18 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
19 CONV4_2 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
20 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
21 CONV4_3 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
22 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
23 MPOOL 	[512, 29, 29] = 430592 	[0, 0, 2, 2] = 0 	[512, 15, 15] = 115200 	0.0
24 CONV5_1 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
25 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
26 CONV5_2 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
27 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
28 CONV5_3 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
29 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
30 MPOOL 	[512, 15, 15] = 115200 	[0, 0, 2, 2] = 0 	[512, 8, 8] = 32768 	0.0
31 FC6 	[512, 8, 8] = 32768 	[512, 4096, 8, 8] = 134217728 	[4096, 1, 1] = 4096 	0.0
32 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
33 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
34 FC7 	[4096, 1, 1] = 4096 	[4096, 4096, 1, 1] = 16777216 	[4096, 1, 1] = 4096 	0.0
35 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
36 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
37 FC8 	[4096, 1, 1] = 4096 	[4096, 1000, 1, 1] = 4096000 	[1000, 1, 1] = 1000 	0.0
Model with 38 layers
Total |x|: 15705164 items
Total |y|: 15552936 items
Total |w|: 169801408 items
Total comp: 0.000526056 sec
Max comp: 0.000526056 sec ==>1900.93830315samples for 100% GPU ultilization
Max |y|: 3268864 items
****
global value g GOAL 1
MAX_MINIBATCH 262144.0
MAX_RANK 2048.0
FIX_MIRCO_BATCH 32.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1280000.0
GPU_PER_NODE 4

{'maxOut': 3268864, 'totalOut': 15552936, 'minFilter': 64, 'minChannel': 3, 'totalIn': 15705164, 'totalComp': 0.000526056, 'totalWeight': 169801408, 'minW': 1}
==========SINGLE-NODE===============
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user for miniBatch:  32.0
==========DATA PARALLELISM==========
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user,  32.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
==========SPATIAL PARALLELISM==========
max_rank 8
maxSamplePerNode: 549.728046905
Use FIX_MIRCO_BATCH set by user,  32.0
2.0 0.0
maxSamplePerNode: 838.568207143
Use FIX_MIRCO_BATCH set by user,  32.0
4.0 0.0
maxSamplePerNode: 1137.36837291
Use FIX_MIRCO_BATCH set by user,  32.0
8.0 0.0
==========FILTER PARALLELISM==========
max_rank 64
Not enough memory to store model and 64.0 samples in Filter-Parallelism with 2.0 GPUs
Not enough memory to store model and 128.0 samples in Filter-Parallelism with 4.0 GPUs
Not enough memory to store model and 256.0 samples in Filter-Parallelism with 8.0 GPUs
Not enough memory to store model and 512.0 samples in Filter-Parallelism with 16.0 GPUs
Not enough memory to store model and 1024.0 samples in Filter-Parallelism with 32.0 GPUs
Not enough memory to store model and 2048.0 samples in Filter-Parallelism with 64.0 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 64.0
maxSamplePerNode: 63.8985367953
Use FIX_MIRCO_BATCH set by user,  32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 64.0
==========Channel PARALLELISM==========
max_rank 3
1
Not enough memory to store model and 64.0 samples in Channel-Parallelism with 2.0 GPUs
Not enough memory to store model and 96.0 samples in Channel-Parallelism with 3 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 3
maxSamplePerNode: 62.1726698253
Use FIX_MIRCO_BATCH set by user,  32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 3
==========DATA + FILTER PARALLELISM==========
Use FIX_MIRCO_BATCH set by user,  32.0
==========DATA + SPATIAL PARALLELISM==========
max_rank 8
maxSamplePerNode: 838.568207143
Use FIX_MIRCO_BATCH set by user,  32.0
4.0 0.0
8.0 0.0
16.0 0.0
32.0 0.0
64.0 0.0
128.0 0.0
256.0 0.0
512.0 0.0
1024.0 0.0
2048.0 0.0
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
single		32.0	1	9360484864.0	673.35168	0	673.35168	12.0
data		64.0	2.0	9360484864.0	336.67584	272.0422528	608.7180928	22.0
data		128.0	4.0	9360484864.0	168.33792	204.3016896	372.6396096	28.0
data		256.0	8.0	9360484864.0	84.16896	477.5656424	561.7346024	80.0
data		512.0	16.0	9360484864.0	42.08448	256.975362	299.059842	80.0
data		1024.0	32.0	9360484864.0	21.04224	133.9451162	154.9873562	96.0
data		2048.0	64.0	9360484864.0	10.52112	69.2462169	79.7673369	128.0
data		4096.0	128.0	9360484864.0	5.26056	36.172894827	41.433454827	128.0
data		8192.0	256.0	9360484864.0	2.63028	19.4755670232	22.1058470232	256.0
data		16384.0	512.0	9360484864.0	1.31514	11.0696545394	12.3847945394	512.0
data		32768.0	1024.0	9360484864.0	0.65757	6.8780742096	7.5356442096	1024.0
data		65536.0	2048.0	9360484864.0	0.328785	4.7090391636	5.0378241636	2048.0
spatial		32.0	2.0	2210706944.0	0.0	592.8250624	592.8250624	20.0
spatial		32.0	4.0	1917138432.0	0.0	869.0650368	869.0650368	60.0
spatial		32.0	8.0	1770354176.0	0.0	4011.424896	4011.424896	536.0
filter2		32.0	2.0	8681279232.0	336.67584	2428.7373696	2765.4132096	94.0
filter2		32.0	4.0	8341676416.0	168.33792	3703.0460544	3871.3839744	260.0
filter2		32.0	8.0	8171875008.0	84.16896	17663.4763872	17747.6453472	2368.0
filter2		32.0	16.0	8086974304.0	42.08448	19934.476272	19976.560752	5328.0
filter2		32.0	32.0	8044523952.0	21.04224	22684.8930144	22705.9352544	12128.0
filter2		32.0	64.0	8023298776.0	10.52112	27289.9349856	27300.4561056	29184.0
filter3		32.0	2.0	8681279232.0	336.67584	2428.7373696	2765.4132096	94.0
filter3		32.0	4.0	8341676416.0	168.33792	3703.0460544	3871.3839744	260.0
filter3		32.0	8.0	8171875008.0	84.16896	17663.4763872	17747.6453472	2368.0
filter3		32.0	16.0	8086974304.0	42.08448	19934.476272	19976.560752	5328.0
filter3		32.0	32.0	8044523952.0	21.04224	22684.8930144	22705.9352544	12128.0
filter3		32.0	64.0	8023298776.0	10.52112	27289.9349856	27300.4561056	29184.0
chan2		32.0	2.0	8681279232.0	336.67584	2428.7373696	2765.4132096	94.0
chan2		32.0	3	8454877354.67	224.450735352	3264.9564928	3489.40722815	177.0
chan3		32.0	2.0	8681279232.0	336.67584	2428.7373696	2765.4132096	94.0
chan3		32.0	3	8454877354.67	224.450735352	3264.9564928	3489.40722815	177.0
df		32.0	4.0	8341676416.0	168.33792	3703.0460544	3871.3839744	260.0
df		64.0	8.0	8341676416.0	84.16896	2939.4644384	3023.6333984	408.0
df		128.0	16.0	8341676416.0	42.08448	1742.626872	1784.711352	480.0
df		256.0	32.0	8341676416.0	21.04224	940.4463992	961.4886392	544.0
df		512.0	64.0	8341676416.0	10.52112	488.4157404	498.9368604	576.0
df		1024.0	128.0	8341676416.0	5.26056	249.6792554	254.9398154	640.0
df		2048.0	256.0	8341676416.0	2.63028	127.159074	129.789354	768.0
df		4096.0	512.0	8341676416.0	1.31514	65.1881861827	66.5033261827	1024.0
df		8192.0	1024.0	8341676416.0	0.65757	34.0100227867	34.6675927867	1024.0
df		16384.0	2048.0	8341676416.0	0.328785	18.3831704969	18.7119554969	2048.0
ds		32.0	4.0	1917138432.0	0.0	869.0650368	869.0650368	60.0
ds		64.0	8.0	1917138432.0	0.0	4782.6609632	4782.6609632	640.0
ds		128.0	16.0	1917138432.0	0.0	3479.2718928	3479.2718928	928.0
ds		256.0	32.0	1917138432.0	0.0	2012.5305992	2012.5305992	1088.0
ds		512.0	64.0	1917138432.0	0.0	1075.3982628	1075.3982628	1152.0
ds		1024.0	128.0	1917138432.0	0.0	555.9056222	555.9056222	1280.0
ds		2048.0	256.0	1917138432.0	0.0	283.4560338	283.4560338	1280.0
ds		4096.0	512.0	1917138432.0	0.0	144.258921261	144.258921261	1536.0
ds		8192.0	1024.0	1917138432.0	0.0	73.8716425622	73.8716425622	2048.0
ds		16384.0	2048.0	1917138432.0	0.0	38.4912318854	38.4912318854	2048.0
================================Below is time mesure by av comp of parallelism measure========================================#######################################################
-net ./VGG_ImageNet_prof.net1 -plat ABCI.plat -goal 1 --paratype ['a']
--cmaxB 262144.0 --cmaxp 2048.0 --cBon 32.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./VGG_ImageNet_prof.net1
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV1_1 	[3, 226, 226] = 153228 	[3, 64, 3, 3] = 1728 	[64, 226, 226] = 3268864 	0.009271468
1 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
2 CONV1_2 	[64, 226, 226] = 3268864 	[64, 64, 3, 3] = 36864 	[64, 226, 226] = 3268864 	0.0
3 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
4 MPOOL 	[64, 226, 226] = 3268864 	[0, 0, 2, 2] = 0 	[64, 113, 113] = 817216 	0.0
5 CONV2_1 	[64, 113, 113] = 817216 	[64, 128, 3, 3] = 73728 	[128, 113, 113] = 1634432 	0.0
6 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
7 CONV2_2 	[128, 113, 113] = 1634432 	[128, 128, 3, 3] = 147456 	[128, 113, 113] = 1634432 	0.0
8 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
9 MPOOL 	[128, 113, 113] = 1634432 	[0, 0, 2, 2] = 0 	[128, 57, 57] = 415872 	0.0
10 CONV3_1 	[128, 57, 57] = 415872 	[128, 256, 3, 3] = 294912 	[256, 57, 57] = 831744 	0.0
11 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
12 CONV3_2 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
13 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
14 CONV3_3 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
15 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
16 MPOOL 	[256, 57, 57] = 831744 	[0, 0, 2, 2] = 0 	[256, 29, 29] = 215296 	0.0
17 CONV4_1 	[256, 29, 29] = 215296 	[256, 512, 3, 3] = 1179648 	[512, 29, 29] = 430592 	0.0
18 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
19 CONV4_2 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
20 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
21 CONV4_3 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
22 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
23 MPOOL 	[512, 29, 29] = 430592 	[0, 0, 2, 2] = 0 	[512, 15, 15] = 115200 	0.0
24 CONV5_1 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
25 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
26 CONV5_2 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
27 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
28 CONV5_3 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
29 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
30 MPOOL 	[512, 15, 15] = 115200 	[0, 0, 2, 2] = 0 	[512, 8, 8] = 32768 	0.0
31 FC6 	[512, 8, 8] = 32768 	[512, 4096, 8, 8] = 134217728 	[4096, 1, 1] = 4096 	0.0
32 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
33 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
34 FC7 	[4096, 1, 1] = 4096 	[4096, 4096, 1, 1] = 16777216 	[4096, 1, 1] = 4096 	0.0
35 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
36 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
37 FC8 	[4096, 1, 1] = 4096 	[4096, 1000, 1, 1] = 4096000 	[1000, 1, 1] = 1000 	0.0
Model with 38 layers
Total |x|: 15705164 items
Total |y|: 15552936 items
Total |w|: 169801408 items
Total comp: 0.009271468 sec
Max comp: 0.009271468 sec ==>107.857784765samples for 100% GPU ultilization
Max |y|: 3268864 items
****
global value g GOAL 1
MAX_MINIBATCH 262144.0
MAX_RANK 2048.0
FIX_MIRCO_BATCH 32.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1280000.0
GPU_PER_NODE 4

{'maxOut': 3268864, 'totalOut': 15552936, 'minFilter': 64, 'minChannel': 3, 'totalIn': 15705164, 'totalComp': 0.009271468, 'totalWeight': 169801408, 'minW': 1}
==========SINGLE-NODE===============
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user for miniBatch:  32.0
==========DATA PARALLELISM==========
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user,  32.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
==========SPATIAL PARALLELISM==========
max_rank 8
maxSamplePerNode: 549.728046905
Use FIX_MIRCO_BATCH set by user,  32.0
2.0 0.0
maxSamplePerNode: 838.568207143
Use FIX_MIRCO_BATCH set by user,  32.0
4.0 0.0
maxSamplePerNode: 1137.36837291
Use FIX_MIRCO_BATCH set by user,  32.0
8.0 0.0
==========FILTER PARALLELISM==========
max_rank 64
Not enough memory to store model and 64.0 samples in Filter-Parallelism with 2.0 GPUs
Not enough memory to store model and 128.0 samples in Filter-Parallelism with 4.0 GPUs
Not enough memory to store model and 256.0 samples in Filter-Parallelism with 8.0 GPUs
Not enough memory to store model and 512.0 samples in Filter-Parallelism with 16.0 GPUs
Not enough memory to store model and 1024.0 samples in Filter-Parallelism with 32.0 GPUs
Not enough memory to store model and 2048.0 samples in Filter-Parallelism with 64.0 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 64.0
maxSamplePerNode: 63.8985367953
Use FIX_MIRCO_BATCH set by user,  32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 64.0
==========Channel PARALLELISM==========
max_rank 3
1
Not enough memory to store model and 64.0 samples in Channel-Parallelism with 2.0 GPUs
Not enough memory to store model and 96.0 samples in Channel-Parallelism with 3 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 3
maxSamplePerNode: 62.1726698253
Use FIX_MIRCO_BATCH set by user,  32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 3
==========DATA + FILTER PARALLELISM==========
Use FIX_MIRCO_BATCH set by user,  32.0
==========DATA + SPATIAL PARALLELISM==========
max_rank 8
maxSamplePerNode: 838.568207143
Use FIX_MIRCO_BATCH set by user,  32.0
4.0 0.0
8.0 0.0
16.0 0.0
32.0 0.0
64.0 0.0
128.0 0.0
256.0 0.0
512.0 0.0
1024.0 0.0
2048.0 0.0
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
single		32.0	1	9360484864.0	11867.47904	0	11867.47904	198.0
data		64.0	2.0	9360484864.0	5933.73952	272.0422528	6205.7817728	208.0
data		128.0	4.0	9360484864.0	2966.86976	204.3016896	3171.1714496	212.0
data		256.0	8.0	9360484864.0	1483.43488	477.5656424	1961.0005224	264.0
data		512.0	16.0	9360484864.0	741.71744	256.975362	998.692802	272.0
data		1024.0	32.0	9360484864.0	370.85872	133.9451162	504.8038362	288.0
data		2048.0	64.0	9360484864.0	185.42936	69.2462169	254.6755769	320.0
data		4096.0	128.0	9360484864.0	92.71468	36.172894827	128.887574827	384.0
data		8192.0	256.0	9360484864.0	46.35734	19.4755670232	65.8329070232	512.0
data		16384.0	512.0	9360484864.0	23.17867	11.0696545394	34.2483245394	512.0
data		32768.0	1024.0	9360484864.0	11.589335	6.8780742096	18.4674092096	1024.0
data		65536.0	2048.0	9360484864.0	5.7946675	4.7090391636	10.5037066636	2048.0
spatial		32.0	2.0	2210706944.0	0.0	592.8250624	592.8250624	20.0
spatial		32.0	4.0	1917138432.0	0.0	869.0650368	869.0650368	60.0
spatial		32.0	8.0	1770354176.0	0.0	4011.424896	4011.424896	536.0
filter2		32.0	2.0	8681279232.0	5933.73952	2428.7373696	8362.4768896	280.0
filter2		32.0	4.0	8341676416.0	2966.86976	3703.0460544	6669.9158144	448.0
filter2		32.0	8.0	8171875008.0	1483.43488	17663.4763872	19146.9112672	2560.0
filter2		32.0	16.0	8086974304.0	741.71744	19934.476272	20676.193712	5520.0
filter2		32.0	32.0	8044523952.0	370.85872	22684.8930144	23055.7517344	12320.0
filter2		32.0	64.0	8023298776.0	185.42936	27289.9349856	27475.3643456	29312.0
filter3		32.0	2.0	8681279232.0	5933.73952	2428.7373696	8362.4768896	280.0
filter3		32.0	4.0	8341676416.0	2966.86976	3703.0460544	6669.9158144	448.0
filter3		32.0	8.0	8171875008.0	1483.43488	17663.4763872	19146.9112672	2560.0
filter3		32.0	16.0	8086974304.0	741.71744	19934.476272	20676.193712	5520.0
filter3		32.0	32.0	8044523952.0	370.85872	22684.8930144	23055.7517344	12320.0
filter3		32.0	64.0	8023298776.0	185.42936	27289.9349856	27475.3643456	29312.0
chan2		32.0	2.0	8681279232.0	5933.73952	2428.7373696	8362.4768896	280.0
chan2		32.0	3	8454877354.67	3955.82943716	3264.9564928	7220.78592996	363.0
chan3		32.0	2.0	8681279232.0	5933.73952	2428.7373696	8362.4768896	280.0
chan3		32.0	3	8454877354.67	3955.82943716	3264.9564928	7220.78592996	363.0
df		32.0	4.0	8341676416.0	2966.86976	3703.0460544	6669.9158144	448.0
df		64.0	8.0	8341676416.0	1483.43488	2939.4644384	4422.8993184	592.0
df		128.0	16.0	8341676416.0	741.71744	1742.626872	2484.344312	672.0
df		256.0	32.0	8341676416.0	370.85872	940.4463992	1311.3051192	704.0
df		512.0	64.0	8341676416.0	185.42936	488.4157404	673.8451004	768.0
df		1024.0	128.0	8341676416.0	92.71468	249.6792554	342.3939354	768.0
df		2048.0	256.0	8341676416.0	46.35734	127.159074	173.516414	768.0
df		4096.0	512.0	8341676416.0	23.17867	65.1881861827	88.3668561827	1024.0
df		8192.0	1024.0	8341676416.0	11.589335	34.0100227867	45.5993577867	1024.0
df		16384.0	2048.0	8341676416.0	5.7946675	18.3831704969	24.1778379969	2048.0
ds		32.0	4.0	1917138432.0	0.0	869.0650368	869.0650368	60.0
ds		64.0	8.0	1917138432.0	0.0	4782.6609632	4782.6609632	640.0
ds		128.0	16.0	1917138432.0	0.0	3479.2718928	3479.2718928	928.0
ds		256.0	32.0	1917138432.0	0.0	2012.5305992	2012.5305992	1088.0
ds		512.0	64.0	1917138432.0	0.0	1075.3982628	1075.3982628	1152.0
ds		1024.0	128.0	1917138432.0	0.0	555.9056222	555.9056222	1280.0
ds		2048.0	256.0	1917138432.0	0.0	283.4560338	283.4560338	1280.0
ds		4096.0	512.0	1917138432.0	0.0	144.258921261	144.258921261	1536.0
ds		8192.0	1024.0	1917138432.0	0.0	73.8716425622	73.8716425622	2048.0
ds		16384.0	2048.0	1917138432.0	0.0	38.4912318854	38.4912318854	2048.0

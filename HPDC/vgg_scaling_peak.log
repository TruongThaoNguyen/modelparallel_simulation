#######################################################
-net ./VGG_ImageNet.net -plat ABCI.plat -goal 1 --paratype ['a']
--cmaxB 262144.0 --cmaxp 2048.0 --cBon 32.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./VGG_ImageNet.net
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV1_1 	[3, 226, 226] = 153228 	[3, 64, 3, 3] = 1728 	[64, 226, 226] = 3268864 	4.52614153846e-05
1 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	8.3817025641e-07
2 CONV1_2 	[64, 226, 226] = 3268864 	[64, 64, 3, 3] = 36864 	[64, 226, 226] = 3268864 	0.000965576861538
3 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	8.3817025641e-07
4 MPOOL 	[64, 226, 226] = 3268864 	[0, 0, 2, 2] = 0 	[64, 113, 113] = 817216 	5.36428964103e-05
5 CONV2_1 	[64, 113, 113] = 817216 	[64, 128, 3, 3] = 73728 	[128, 113, 113] = 1634432 	0.00048279552
6 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	4.19085128205e-07
7 CONV2_2 	[128, 113, 113] = 1634432 	[128, 128, 3, 3] = 147456 	[128, 113, 113] = 1634432 	0.00096559104
8 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	4.19085128205e-07
9 MPOOL 	[128, 113, 113] = 1634432 	[0, 0, 2, 2] = 0 	[128, 57, 57] = 415872 	5.45965292308e-05
10 CONV3_1 	[128, 57, 57] = 415872 	[128, 256, 3, 3] = 294912 	[256, 57, 57] = 831744 	0.000491406572308
11 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	2.13267692308e-07
12 CONV3_2 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.000982813144615
13 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	2.13267692308e-07
14 CONV3_3 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.000982813144615
15 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	2.13267692308e-07
16 MPOOL 	[256, 57, 57] = 831744 	[0, 0, 2, 2] = 0 	[256, 29, 29] = 215296 	5.65290010256e-05
17 CONV4_1 	[256, 29, 29] = 215296 	[256, 512, 3, 3] = 1179648 	[512, 29, 29] = 430592 	0.000508912246154
18 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	1.10408205128e-07
19 CONV4_2 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.00101782449231
20 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	1.10408205128e-07
21 CONV4_3 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.00101782449231
22 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	1.10408205128e-07
23 MPOOL 	[512, 29, 29] = 430592 	[0, 0, 2, 2] = 0 	[512, 15, 15] = 115200 	6.04947692308e-05
24 CONV5_1 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.000272528935385
25 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	2.95384615385e-08
26 CONV5_2 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.000272528935385
27 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	2.95384615385e-08
28 CONV5_3 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.000272528935385
29 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	2.95384615385e-08
30 MPOOL 	[512, 15, 15] = 115200 	[0, 0, 2, 2] = 0 	[512, 8, 8] = 32768 	1.72074010256e-05
31 FC6 	[512, 8, 8] = 32768 	[512, 4096, 8, 8] = 134217728 	[4096, 1, 1] = 4096 	5.16222030769e-05
32 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	1.05025641026e-09
33 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
34 FC7 	[4096, 1, 1] = 4096 	[4096, 4096, 1, 1] = 16777216 	[4096, 1, 1] = 4096 	6.45277538462e-06
35 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	1.05025641026e-09
36 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
37 FC8 	[4096, 1, 1] = 4096 	[4096, 1000, 1, 1] = 4096000 	[1000, 1, 1] = 1000 	1.57538461538e-06
Model with 38 layers
Total |x|: 15705164 items
Total |y|: 15552936 items
Total |w|: 169801408 items
Total comp: 0.00858410294974 sec
Max comp: 0.00101782449231 sec ==>116.494409009samples for 100% GPU ultilization
Max |y|: 3268864 items
****
global value g GOAL 1
MAX_MINIBATCH 262144.0
MAX_RANK 2048.0
FIX_MIRCO_BATCH 32.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1280000.0
GPU_PER_NODE 4

{'maxOut': 3268864, 'totalOut': 15552936, 'minFilter': 64, 'minChannel': 3, 'totalIn': 15705164, 'totalComp': 0.008584102949743582, 'totalWeight': 169801408, 'minW': 1}
==========SINGLE-NODE===============
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user for miniBatch:  32.0
==========DATA PARALLELISM==========
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user,  32.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
32.0 31258100 169801408 4.0
==========SPATIAL PARALLELISM==========
max_rank 8
maxSamplePerNode: 549.728046905
Use FIX_MIRCO_BATCH set by user,  32.0
2.0 0.000387166523077
maxSamplePerNode: 838.568207143
Use FIX_MIRCO_BATCH set by user,  32.0
4.0 0.000253809165128
maxSamplePerNode: 1137.36837291
Use FIX_MIRCO_BATCH set by user,  32.0
8.0 0.000187130486154
==========FILTER PARALLELISM==========
max_rank 64
Not enough memory to store model and 64.0 samples in Filter-Parallelism with 2.0 GPUs
Not enough memory to store model and 128.0 samples in Filter-Parallelism with 4.0 GPUs
Not enough memory to store model and 256.0 samples in Filter-Parallelism with 8.0 GPUs
Not enough memory to store model and 512.0 samples in Filter-Parallelism with 16.0 GPUs
Not enough memory to store model and 1024.0 samples in Filter-Parallelism with 32.0 GPUs
Not enough memory to store model and 2048.0 samples in Filter-Parallelism with 64.0 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 64.0
maxSamplePerNode: 63.8985367953
Use FIX_MIRCO_BATCH set by user,  32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 4.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 8.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 16.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 64.0
==========Channel PARALLELISM==========
max_rank 3
1
Not enough memory to store model and 64.0 samples in Channel-Parallelism with 2.0 GPUs
Not enough memory to store model and 96.0 samples in Channel-Parallelism with 3 GPUs
Get result from Case 2 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 2 with miniBatch 32.0 nodeNumber 3
maxSamplePerNode: 62.1726698253
Use FIX_MIRCO_BATCH set by user,  32.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 2.0
Get result from Case 3 with miniBatch 32.0 nodeNumber 3
==========DATA + FILTER PARALLELISM==========
Use FIX_MIRCO_BATCH set by user,  32.0
==========DATA + SPATIAL PARALLELISM==========
max_rank 8
maxSamplePerNode: 838.568207143
Use FIX_MIRCO_BATCH set by user,  32.0
4.0 0.000253809165128
8.0 0.000253809165128
16.0 0.000253809165128
32.0 0.000253809165128
64.0 0.000253809165128
128.0 0.000253809165128
256.0 0.000253809165128
512.0 0.000253809165128
1024.0 0.000253809165128
2048.0 0.000253809165128
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
single		32.0	1	9360484864.0	10987.6517757	0	10987.6517757	184.0
data		64.0	2.0	9360484864.0	5493.82588784	272.0422528	5765.86814064	194.0
data		128.0	4.0	9360484864.0	2746.91294392	204.3016896	2951.21463352	200.0
data		256.0	8.0	9360484864.0	1373.45647196	477.5656424	1851.02211436	248.0
data		512.0	16.0	9360484864.0	686.728235979	256.975362	943.703597979	256.0
data		1024.0	32.0	9360484864.0	343.36411799	133.9451162	477.30923419	256.0
data		2048.0	64.0	9360484864.0	171.682058995	69.2462169	240.928275895	320.0
data		4096.0	128.0	9360484864.0	85.8410294974	36.172894827	122.013924324	384.0
data		8192.0	256.0	9360484864.0	42.9205147487	19.4755670232	62.3960817719	512.0
data		16384.0	512.0	9360484864.0	21.4602573744	11.0696545394	32.5299119138	512.0
data		32768.0	1024.0	9360484864.0	10.7301286872	6.8780742096	17.6082028968	1024.0
data		65536.0	2048.0	9360484864.0	5.36506434359	4.7090391636	10.0741035072	2048.0
spatial		32.0	2.0	2210706944.0	495.573149538	592.8250624	1088.39821194	38.0
spatial		32.0	4.0	1917138432.0	324.875731364	869.0650368	1193.94076816	80.0
spatial		32.0	8.0	1770354176.0	239.527022277	4011.424896	4250.95191828	568.0
filter2		32.0	2.0	8681279232.0	5493.82588784	2428.7373696	7922.56325744	266.0
filter2		32.0	4.0	8341676416.0	2746.91294392	3703.0460544	6449.95899832	432.0
filter2		32.0	8.0	8171875008.0	1373.45647196	17663.4763872	19036.9328592	2544.0
filter2		32.0	16.0	8086974304.0	686.728235979	19934.476272	20621.204508	5504.0
filter2		32.0	32.0	8044523952.0	343.36411799	22684.8930144	23028.2571324	12288.0
filter2		32.0	64.0	8023298776.0	171.682058995	27289.9349856	27461.6170446	29312.0
filter3		32.0	2.0	8681279232.0	5493.82588784	2428.7373696	7922.56325744	266.0
filter3		32.0	4.0	8341676416.0	2746.91294392	3703.0460544	6449.95899832	432.0
filter3		32.0	8.0	8171875008.0	1373.45647196	17663.4763872	19036.9328592	2544.0
filter3		32.0	16.0	8086974304.0	686.728235979	19934.476272	20621.204508	5504.0
filter3		32.0	32.0	8044523952.0	343.36411799	22684.8930144	23028.2571324	12288.0
filter3		32.0	64.0	8023298776.0	171.682058995	27289.9349856	27461.6170446	29312.0
chan2		32.0	2.0	8681279232.0	5493.82588784	2428.7373696	7922.56325744	266.0
chan2		32.0	3	8454877354.67	3662.55345326	3264.9564928	6927.50994606	348.0
chan3		32.0	2.0	8681279232.0	5493.82588784	2428.7373696	7922.56325744	266.0
chan3		32.0	3	8454877354.67	3662.55345326	3264.9564928	6927.50994606	348.0
df		32.0	4.0	8341676416.0	2746.91294392	3703.0460544	6449.95899832	432.0
df		64.0	8.0	8341676416.0	1373.45647196	2939.4644384	4312.92091036	576.0
df		128.0	16.0	8341676416.0	686.728235979	1742.626872	2429.35510798	656.0
df		256.0	32.0	8341676416.0	343.36411799	940.4463992	1283.81051719	704.0
df		512.0	64.0	8341676416.0	171.682058995	488.4157404	660.097799395	768.0
df		1024.0	128.0	8341676416.0	85.8410294974	249.6792554	335.520284897	768.0
df		2048.0	256.0	8341676416.0	42.9205147487	127.159074	170.079588749	768.0
df		4096.0	512.0	8341676416.0	21.4602573744	65.1881861827	86.6484435571	1024.0
df		8192.0	1024.0	8341676416.0	10.7301286872	34.0100227867	44.7401514739	1024.0
df		16384.0	2048.0	8341676416.0	5.36506434359	18.3831704969	23.7482348405	2048.0
ds		32.0	4.0	1917138432.0	324.875731364	869.0650368	1193.94076816	80.0
ds		64.0	8.0	1917138432.0	162.437865682	4782.6609632	4945.09882888	664.0
ds		128.0	16.0	1917138432.0	81.218932841	3479.2718928	3560.49082564	960.0
ds		256.0	32.0	1917138432.0	40.6094664205	2012.5305992	2053.14006562	1120.0
ds		512.0	64.0	1917138432.0	20.3047332103	1075.3982628	1095.70299601	1216.0
ds		1024.0	128.0	1917138432.0	10.1523666051	555.9056222	566.057988805	1280.0
ds		2048.0	256.0	1917138432.0	5.07618330256	283.4560338	288.532217103	1280.0
ds		4096.0	512.0	1917138432.0	2.53809165128	144.258921261	146.797012912	1536.0
ds		8192.0	1024.0	1917138432.0	1.26904582564	73.8716425622	75.1406883879	2048.0
ds		16384.0	2048.0	1917138432.0	0.634522912821	38.4912318854	39.1257547983	2048.0
